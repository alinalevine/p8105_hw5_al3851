---
title: "p8105_hw5_al3851"
author: "Alina Levine"
date: "November 3, 2018"
output: html_document
---

```{r setup, include=FALSE}

library(tidyverse)

```

#Create Dataframe

I am first making a tibble with one column that consists of the file name for each person. then I am mapping over each file name and am applying the read_csv function, which will give me a list with the value each week for each person. I will replace give with "con" in the file name the value of "control" for group and all other people will get experimental. 
```{r create dataframe, resul}

study_df = 
  tibble(file = str_c("./Data/", list.files("./Data"))) %>%
  mutate(data = map(.x = file, read_csv)) %>%
  bind_rows %>%
  unnest() %>%
  mutate(group = ifelse( str_detect(file, "./Data/con_[0-9][0-9].csv"), 
                        "control", 
                        "experimental")) %>%
  mutate(subj_id = str_replace_all(file,"[^0-9]","")) %>%
  gather(key = "week", value = "value", week_1:week_8) %>%
  mutate(week = str_replace(week, "week_","")) %>%
  mutate( week = as.numeric(week))
  
  
  

```


```{r spaghetti plot, results = "hide", warning = FALSE, message = FALSE}

  ggplot(study_df, aes(x = week, y = value, color = group)) +
    geom_line(aes(group = interaction(group, subj_id))) +
  labs(title = "Outcome Over 8 Week Period")
    
  
```


The value for people in the experimental groups tends to increase over time, while the value for people in the control group does not increase over time. In fact, it looks as though the value tends to decrease slightly over time for the control group. 